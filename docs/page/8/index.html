<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Even - A super concise theme for Hugo</title>
<meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=Cache-Control content="no-transform"><meta http-equiv=Cache-Control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content><meta name=description content="Hugo theme even example site."><meta name=keywords content="Hugo,theme,even"><meta name=generator content="Hugo 0.147.0 with theme even"><link rel=canonical href=https://lppgo.github.io/><link href=https://lppgo.github.io/index.xml rel=alternate type=application/rss+xml title="Even - A super concise theme for Hugo"><link href=https://lppgo.github.io/index.xml rel=feed type=application/rss+xml title="Even - A super concise theme for Hugo"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link href=/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:url" content="https://lppgo.github.io/"><meta property="og:site_name" content="Even - A super concise theme for Hugo"><meta property="og:title" content="Even - A super concise theme for Hugo"><meta property="og:description" content="Hugo theme even example site."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Even - A super concise theme for Hugo"><meta itemprop=description content="Hugo theme even example site."><meta itemprop=datePublished content="2026-02-27T00:00:00+00:00"><meta itemprop=dateModified content="2026-02-27T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Even - A super concise theme for Hugo"><meta name=twitter:description content="Hugo theme even example site."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>lppgo</a></div><div class=mobile-navbar-icon><span></span>
<span></span>
<span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>Home</li></a><a href=/post/><li class=mobile-menu-item>Archives</li></a><a href=/categories/><li class=mobile-menu-item>Categories</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>lppgo</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Home</a></li><li class=menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/categories/>Categories</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><section id=posts class=posts><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/post/golang/015-file-and-io/>01-Golang Files and I/O</a></h1><div class=post-meta><span class=post-time>2021-08-10</span><div class=post-category><a href=/categories/go/>Go</a></div></div></header><div class=post-content><div class=post-summary><div align=center><font size=50>Golang Files and I/O</font></div><h1 id=table-of-contents>Table of Contents</h1><ul><li><a href=#table-of-contents>Table of Contents</a></li><li><a href=#%E4%B8%80%E8%AF%BB%E6%96%87%E4%BB%B6>一：读文件</a><ul><li><a href=#11-%E8%AF%BB%E4%B8%80%E4%B8%AA-whole-%E6%96%87%E4%BB%B6>1.1 读一个 whole 文件</a></li><li><a href=#12-%E8%AF%BB%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6close>1.2 读一个文件，close</a></li><li><a href=#13-read-file-by-line>1.3 read file by line</a></li></ul></li><li><a href=#%E4%BA%8C%E5%86%99%E6%96%87%E4%BB%B6>二：写文件</a><ul><li><a href=#21-write-the-whole-file>2.1 Write the whole file</a></li><li><a href=#22-open-file-for-writing>2.2 Open file for writing</a></li><li><a href=#23-open-file-for-appending>2.3 Open file for appending</a></li><li><a href=#24-write-to-a-file>2.4 Write to a file</a></li><li><a href=#25-file-permissions-when-creating-files>2.5 File permissions when creating files</a></li></ul></li><li><a href=#%E4%B8%89file-operations>三：File Operations</a><ul><li><a href=#31-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6-size>3.1 获取文件 size</a></li><li><a href=#32-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6-information>3.2 获取文件 information</a></li><li><a href=#33-%E6%A3%80%E6%9F%A5%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6-exist>3.3 检查文件是否 Exist</a></li><li><a href=#34-delete-file>3.4 Delete File</a></li><li><a href=#35-rename-file>3.5 Rename File</a></li><li><a href=#36-copy-a-file>3.6 Copy a File</a></li></ul></li><li><a href=#%E5%9B%9B%E7%9B%AE%E5%BD%95%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C-directory-operations>四：目录相关操作 Directory Operations</a><ul><li><a href=#41-create-directory>4.1 Create directory</a></li><li><a href=#42-remove-directory>4.2 Remove Directory</a></li><li><a href=#43-%E5%88%97%E5%87%BA%E7%9B%AE%E5%BD%95%E4%B8%8B%E9%9D%A2%E7%9A%84%E6%96%87%E4%BB%B6-list-files-in-a-directory>4.3 列出目录下面的文件 List files in a directory</a></li><li><a href=#44-recursive-%E9%80%92%E5%BD%92%E7%9A%84-list-%E6%96%87%E4%BB%B6>4.4 Recursive 递归的 List 文件</a></li></ul></li><li><a href=#%E4%BA%94file-path-operations>五：File Path Operations</a><ul><li><a href=#51-join-a-path>5.1 Join a path</a></li><li><a href=#52-split-a-path-into-a-directory-and-file>5.2 Split a path into a directory and file</a></li><li><a href=#53-split-list-of-paths>5.3 Split list of paths</a></li><li><a href=#54-get-file-name-from-path>5.4 Get file name from path</a></li><li><a href=#55-get-directory-name-from-path>5.5 Get directory name from path</a></li><li><a href=#56-%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E6%8B%93%E5%B1%95%E5%90%8D-get-file-extension>5.6 获取文件拓展名 Get file extension</a></li></ul></li><li><a href=#%E5%85%ADio-related-interface>六：IO related interface</a><ul><li><a href=#61-ioreader>6.1 io.Reader</a></li><li><a href=#62-iowriter>6.2 io.Writer</a></li><li><a href=#63-iocloser>6.3 io.Closer</a></li><li><a href=#64-ioreaderat>6.4 io.ReaderAt</a></li><li><a href=#65-iowriterat>6.5 io.WriterAt</a></li><li><a href=#66-ioseeker>6.6 io.Seeker</a></li></ul></li></ul><h1 id=一读文件>一：读文件</h1><h2 id=11-读一个-whole-文件>1.1 读一个 whole 文件</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>d</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>ioutil</span><span class=p>.</span><span class=nf>ReadFile</span><span class=p>(</span><span class=s>&#34;foo.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>log</span><span class=p>.</span><span class=nf>Fatalf</span><span class=p>(</span><span class=s>&#34;ioutil.ReadFile failed with &#39;%s&#39;\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Size of &#39;foo.txt&#39;: %d bytes\n&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>d</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=12-读一个文件close>1.2 读一个文件，close</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>f</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=s>&#34;foo.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>log</span><span class=p>.</span><span class=nf>Fatalf</span><span class=p>(</span><span class=s>&#34;os.Open failed with &#39;%s&#39;\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>defer</span> <span class=nx>f</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=13-read-file-by-line>1.3 read file by line</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// ReadLines reads all lines from a file</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>ReadLines</span><span class=p>(</span><span class=nx>filePath</span> <span class=kt>string</span><span class=p>)</span> <span class=p>([]</span><span class=kt>string</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>file</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>OpenFile</span><span class=p>(</span><span class=nx>filePath</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>O_RDONLY</span><span class=p>,</span> <span class=mo>0644</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>defer</span> <span class=nx>file</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>scanner</span> <span class=o>:=</span> <span class=nx>bufio</span><span class=p>.</span><span class=nf>NewScanner</span><span class=p>(</span><span class=nx>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>res</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>string</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>scanner</span><span class=p>.</span><span class=nf>Scan</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>line</span> <span class=o>:=</span> <span class=nx>scanner</span><span class=p>.</span><span class=nf>Text</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=nx>res</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>res</span><span class=p>,</span> <span class=nx>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>scanner</span><span class=p>.</span><span class=nf>Err</span><span class=p>();</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>res</span><span class=p>,</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>path</span> <span class=o>:=</span> <span class=s>&#34;main.go&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nx>lines</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nf>ReadLines</span><span class=p>(</span><span class=nx>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>log</span><span class=p>.</span><span class=nf>Fatalf</span><span class=p>(</span><span class=s>&#34;ReadLines failed with &#39;%s&#39;\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;File %s has %d lines\n&#34;</span><span class=p>,</span> <span class=nx>path</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>lines</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=二写文件>二：写文件</h1><h2 id=21-write-the-whole-file>2.1 Write the whole file</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>d</span> <span class=o>:=</span> <span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&#34;content of the file&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>err</span> <span class=o>:=</span> <span class=nx>ioutil</span><span class=p>.</span><span class=nf>WriteFile</span><span class=p>(</span><span class=s>&#34;foo.txt&#34;</span><span class=p>,</span> <span class=nx>d</span><span class=p>,</span> <span class=mo>0644</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>log</span><span class=p>.</span><span class=nf>Fatalf</span><span class=p>(</span><span class=s>&#34;ioutil.WriteFile failed with &#39;%s&#39;\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=22-open-file-for-writing>2.2 Open file for writing</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>f</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Create</span><span class=p>(</span><span class=s>&#34;foo.txt&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>log</span><span class=p>.</span><span class=nf>Fatalf</span><span class=p>(</span><span class=s>&#34;os.Open failed with &#39;%s&#39;\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=23-open-file-for-appending>2.3 Open file for appending</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>f</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>os</span><span class=p>.</span><span class=nf>OpenFile</span><span class=p>(</span><span class=nx>filePath</span><span class=p>,</span> <span class=nx>os</span><span class=p>.</span><span class=nx>O_WRONLY</span> <span class=p>|</span> <span class=nx>os</span><span class=p>.</span><span class=nx>O_APPEND</span> <span class=p>|</span> <span class=nx>os</span><span class=p>.</span><span class=nx>O_CREATE</span><span class=p>,</span> <span class=mo>0666</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>log</span><span class=p>.</span><span class=nf>Fatalf</span><span class=p>(</span><span class=s>&#34;os.Open failed with &#39;%s&#39;\n&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=24-write-to-a-file>2.4 Write to a file</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=nx>d</span> <span class=o>:=</span> <span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=s>&#34;data to write&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>nWritten</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>f</span><span class=p>.</span><span class=nf>Write</span><span class=p>(</span><span class=nx>d</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=25-file-permissions-when-creating-files>2.5 File permissions when creating files</h2><p>使用 os.Create 或创建新文件时 os.OpenFile，需要为新文件提供文件权限。</p></div><div class=read-more><a href=/post/golang/015-file-and-io/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/post/golang/013-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%99%90%E6%B5%81%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/>01-微服务限流简单实现</a></h1><div class=post-meta><span class=post-time>2021-08-03</span><div class=post-category><a href=/categories/go/>Go</a></div></div></header><div class=post-content><div class=post-summary><div align=center><font size=50>微服务限流简单实现</font></div><h1 id=table-of-contents>Table of Contents</h1><ul><li><a href=#table-of-contents>Table of Contents</a></li><li><a href=#%E4%B8%80%E9%99%90%E6%B5%81%E7%9A%84%E7%9B%AE%E7%9A%84>一：限流的目的</a></li><li><a href=#%E4%BA%8C%E9%99%90%E6%B5%81%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F>二：限流实现方式</a><ul><li><a href=#1%E5%9B%BA%E5%AE%9A%E7%AA%97%E5%8F%A3>1：固定窗口</a><ul><li><a href=#%E6%80%9D%E6%83%B3>思想</a></li><li><a href=#%E5%AE%9E%E7%8E%B0>实现</a></li><li><a href=#%E9%97%AE%E9%A2%98>问题</a></li></ul></li><li><a href=#2%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3>2：滑动窗口</a><ul><li><a href=#%E6%80%9D%E6%83%B3-1>思想</a></li><li><a href=#%E5%AE%9E%E7%8E%B0-1>实现</a></li><li><a href=#%E7%9B%B8%E5%AF%B9%E4%BA%8E%E5%9B%BA%E5%AE%9A%E7%AA%97%E5%8F%A3%E7%9A%84%E6%94%B9%E8%BF%9B>相对于固定窗口的改进</a></li></ul></li><li><a href=#3%E6%BC%8F%E6%A1%B6>3：漏桶</a><ul><li><a href=#%E6%80%9D%E6%83%B3-2>思想</a></li><li><a href=#%E5%AE%9E%E7%8E%B0-2>实现</a></li><li><a href=#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF>适用场景</a></li></ul></li><li><a href=#4%E4%BB%A4%E7%89%8C%E6%A1%B6>4：令牌桶</a><ul><li><a href=#%E6%80%9D%E6%83%B3-3>思想</a></li><li><a href=#%E5%AE%9E%E7%8E%B0-3>实现</a></li><li><a href=#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF-1>适用场景</a>
_ <a href=#%E6%80%9D%E6%83%B3-3>思想</a>
_ <a href=#%E5%AE%9E%E7%8E%B0-3>实现</a> * <a href=#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF-1>适用场景</a></li></ul></li></ul></li></ul><h1 id=一限流的目的>一：限流的目的</h1><p>保障服务稳定的三大利器：熔断、降级、服务限流。今天和大家谈谈限流算法的几种实现方式，本文所说的限流并非是 Nginx、网关层面的限流，而是业务代码中的逻辑限流。</p></div><div class=read-more><a href=/post/golang/013-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%99%90%E6%B5%81%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/post/dockerk8s/009-docker-registry-http-api-v2/>01-docker registry http api v2</a></h1><div class=post-meta><span class=post-time>2021-07-28</span><div class=post-category><a href=/categories/docker/>Docker</a></div></div></header><div class=post-content><div class=post-summary><div align=center><font size=50>docker registry http api v2</font></div><h1 id=table-of-contents>Table of Contents</h1><ul><li><a href=#table-of-contents>Table of Contents</a></li><li><a href=#1-overview>1: Overview</a></li><li><a href=#2-%E4%B8%93%E6%9C%89%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A>2: 专有名词解释</a></li><li><a href=#3-push-image-%E8%BF%87%E7%A8%8B>3: Push image 过程</a><ul><li><a href=#31-pushing-a-layer%E4%B8%8A%E4%BC%A0%E5%B1%82>3.1 Pushing a Layer（上传层）</a><ul><li><a href=#311-existing-layers%E6%A3%80%E6%9F%A5%E5%B1%82%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8>3.1.1 Existing Layers(检查层是否存在)</a></li><li><a href=#312-starting-an-upload%E5%90%AF%E5%8A%A8%E4%B8%8A%E4%BC%A0%E6%9C%8D%E5%8A%A1>3.1.2 Starting An Upload(启动上传服务)</a></li><li><a href=#313-uploading-the-layer%E4%B8%8A%E4%BC%A0%E5%B1%82>3.1.3 Uploading the Layer(上传层)</a><ul><li><a href=#3131-upload-progress%E4%B8%8A%E4%BC%A0%E8%BF%9B%E5%BA%A6>3.1.3.1 Upload Progress(上传进度)</a></li><li><a href=#3132-monolithic-upload%E6%95%B4%E5%9D%97%E4%B8%8A%E4%BC%A0>3.1.3.2 Monolithic Upload(整块上传）</a></li><li><a href=#3133-chunked-upload%E5%88%86%E5%9D%97%E4%B8%8A%E4%BC%A0>3.1.3.3 Chunked Upload（分块上传）</a></li><li><a href=#3134-completed-upload%E4%B8%8A%E4%BC%A0%E5%AE%8C%E6%88%90>3.1.3.4 Completed Upload(上传完成)</a></li><li><a href=#3135-canceling-an-upload%E5%8F%96%E6%B6%88%E4%B8%8A%E4%BC%A0>3.1.3.5 Canceling an Upload(取消上传)</a></li><li><a href=#3136-cross-repository-blob-mount%E4%BA%A4%E5%8F%89%E6%8C%82%E8%BD%BD%E5%B1%82>3.1.3.6 Cross Repository Blob Mount（交叉挂载层）</a></li></ul></li></ul></li><li><a href=#32-deleting-a-layer%E5%88%A0%E9%99%A4%E5%B1%82>3.2 Deleting a Layer(删除层)</a></li><li><a href=#33-pushing-an-image-manifest%E4%B8%8A%E4%BC%A0%E9%95%9C%E5%83%8F%E6%B8%85%E5%8D%95>3.3 Pushing an Image Manifest（上传镜像清单）</a></li></ul></li><li><a href=#4-pull-image-%E8%BF%87%E7%A8%8B>4: Pull image 过程</a><ul><li><a href=#41-pulling-an-image-manifest%E6%8B%89%E5%8F%96%E9%95%9C%E5%83%8F%E6%B8%85%E5%8D%95>4.1 Pulling an Image Manifest（拉取镜像清单）</a></li><li><a href=#42-pulling-a-layer%E6%8B%89%E5%8F%96%E5%B1%82>4.2 Pulling a Layer（拉取层）</a></li></ul></li><li><a href=#5-retrieve-%E6%A3%80%E7%B4%A2%E5%8A%9F%E8%83%BD>5: Retrieve 检索功能</a><ul><li><a href=#51-listing-repositories%E5%88%97%E5%87%BA%E5%AD%98%E5%82%A8%E5%BA%93>5.1 Listing Repositories（列出存储库）</a></li><li><a href=#52-pagination%E9%83%A8%E5%88%86%E5%88%97%E5%87%BA%E5%AD%98%E5%82%A8%E5%BA%93>5.2 Pagination(部分列出存储库)</a></li><li><a href=#53-listing-image-tags%E5%88%97%E5%87%BA%E9%95%9C%E5%83%8F-tag>5.3 Listing Image Tags(列出镜像 tag)</a></li><li><a href=#54-pagination%E9%83%A8%E5%88%86%E5%88%97%E5%87%BA%E9%95%9C%E5%83%8F-tag>5.4 Pagination(部分列出镜像 tag)</a></li></ul></li><li><a href=#6-deleteing-an-image%E5%88%A0%E9%99%A4%E9%95%9C%E5%83%8F>6: Deleteing an Image（删除镜像）</a></li><li><a href=#7-errors-%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF>7: Errors 错误信息</a></li></ul><h1 id=1-overview>1: Overview</h1><table><thead><tr><th>methods</th><th>path</th><th>Entity</th><th>Description</th></tr></thead><tbody><tr><td>GET</td><td>/v2/</td><td>Base</td><td>检查 the endpoint 是否实现了 Docker Registry API V2.</td></tr><tr><td>GET</td><td>/v2/{name}/tags/list</td><td>Tags</td><td>通过 name 获取 repository 下的 tags</td></tr><tr><td>GET</td><td>/v2/{name}/manifests/{reference}</td><td>Manifest</td><td>获取由 name 和 references 标识的 manifest，其中 referencec 可以是 tag 或 digest。还可以向该 endpoint 发出 HEAD 请求以获取资源信息，而不接收所有数据。</td></tr><tr><td>PUT</td><td>/v2/{name}/manifests/{reference}</td><td>Manifest</td><td>Put 由 name 和 reference 标识的 manifest</td></tr><tr><td>DELETE</td><td>/v2/{name}/manifests/{reference}</td><td>Manifest</td><td>删除由 digest 标识的 manifest</td></tr><tr><td>GET</td><td>/v2/{name}/blobs/{digest}</td><td>Blob</td><td>从 registry retrieve 由 digest 标识的 blobs</td></tr><tr><td>DELETE</td><td>/v2/{name}/blobs/{digest}</td><td>Blob</td><td>Delete the blob identified by name and digest</td></tr><tr><td>POST</td><td>/v2/{name}/blobs/uploads/</td><td>Initiate(启动) Blob upload 服务</td><td>启动可恢复的 blob upload 服务。如果成功，将提供上载位置以完成上载。或者，如果存在 digest 参数，则请求正文将用于在单个请求中完成上载。</td></tr><tr><td>GET</td><td>/v2/{name}/blobs/uploads/{uuid}</td><td>Blob Upload</td><td>检索由 uuid 标识的上传状态。此 endpoint 的主要目的是 resolve 可恢复 upload 的当前状态。</td></tr><tr><td>PATCH</td><td>/v2/{name}/blobs/uploads/{uuid}</td><td>Blob Upload</td><td>上传 指定 upload 的 chunk 数据块</td></tr><tr><td>PUT</td><td>/v2/{name}/blobs/uploads/{uuid}</td><td>Blob Upload</td><td>完成 uuid 指定的上传，可以选择附加 body 作为最后一个块</td></tr><tr><td>DELETE</td><td>/v2/{name}/blobs/uploads/{uuid}</td><td>Blob Upload</td><td>Cancel <strong>outstanding</strong> upload processes, releasing associated resources. If this is not called, the unfinished uploads will <strong>eventually</strong> timeout.</td></tr><tr><td>GET</td><td>/v2/_catalog</td><td>Catalog</td><td>在 registry 中检索一个有序的，可用的 repositry 的 json 列表</td></tr></tbody></table><h1 id=2-专有名词解释>2: 专有名词解释</h1><ul><li><strong>repositry name</strong>(存储库名称):存储库指在库中存储的镜像</li><li><strong>digest</strong>(摘要):是 image 各个层的唯一标识。虽然算法允许使用任意算法，但是为了兼容性应该使用 sha256。
例：<code>sha256:6c3c624b58dbbcd3c0dd82b4c53f04194d1247c6eebdaab7c610cf7d66709b3b</code></li></ul><h1 id=3-push-image-过程>3: Push image 过程</h1><blockquote><p>先推各个 Layer 层到 registry 仓库，然后上传清单 Manifest</p></div><div class=read-more><a href=/post/dockerk8s/009-docker-registry-http-api-v2/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/post/dockerk8s/001-wsl2%E4%B8%AD%E9%85%8D%E7%BD%AEdocker%E8%BF%9C%E7%A8%8Btcp/>01-WSL2中配置docker远程tcp</a></h1><div class=post-meta><span class=post-time>2021-07-27</span><div class=post-category><a href=/categories/docker/>Docker</a></div></div></header><div class=post-content><div class=post-summary><div align=center><font size=50>WSL2中配置docker远程tcp</font></div><ul><li><a href=#1-%E4%BF%AE%E6%94%B9-libsystemdsystemdockerservice>1: 修改 <code>/lib/systemd/system/docker.service</code></a></li><li><a href=#2-%E8%AE%BE%E7%BD%AE-docker_host-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F>2: 设置 <code>DOCKER_HOST</code> 环境变量</a></li><li><a href=#3-%E4%BF%AE%E6%94%B9-docker-%E5%90%AF%E5%8A%A8%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6etcdefaultdocker>3: 修改 docker 启动配置文件<code>/etc/default/docker</code></a></li><li><a href=#4-%E9%87%8D%E5%90%AF-docker>4: 重启 docker</a></li></ul><hr><h1 id=1-修改-libsystemdsystemdockerservice>1: 修改 <code>/lib/systemd/system/docker.service</code></h1><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># sudo vim /lib/systemd/system/docker.service</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>Service<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>ExecStart</span><span class=o>=</span>/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock -H fd:// --containerd<span class=o>=</span>/run/containerd/containerd.sock
</span></span><span class=line><span class=cl><span class=c1># 上面这一行,主要是增加了`-H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock`</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=2-设置-docker_host-环境变量>2: 设置 <code>DOCKER_HOST</code> 环境变量</h1><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># sudo vim ~/.zshrc</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>DOCKER_HOST</span><span class=o>=</span>tcp://0.0.0.0:2375
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>source</span> ~/.zshrc
</span></span></code></pre></td></tr></table></div></div><h1 id=3-修改-docker-启动配置文件etcdefaultdocker>3: 修改 docker 启动配置文件<code>/etc/default/docker</code></h1><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 开启远程访问 -H tcp://0.0.0.0:2375</span>
</span></span><span class=line><span class=cl><span class=c1># 开启本地套接字访问 -H unix:///var/run/docker.sock</span>
</span></span><span class=line><span class=cl><span class=nv>DOCKER_OPTS</span><span class=o>=</span><span class=s2>&#34;-H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=4-重启-docker>4: 重启 docker</h1><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo service docker restart
</span></span></code></pre></td></tr></table></div></div></div><div class=read-more><a href=/post/dockerk8s/001-wsl2%E4%B8%AD%E9%85%8D%E7%BD%AEdocker%E8%BF%9C%E7%A8%8Btcp/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/post/database/005-mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96%E6%9C%80%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/>01-mysql数据库优化最完整指南</a></h1><div class=post-meta><span class=post-time>2021-06-11</span><div class=post-category><a href=/categories/database/>DataBase</a></div></div></header><div class=post-content><div class=post-summary><ul><li><a href=#%E9%98%B6%E6%AE%B5%E4%B8%80-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E8%AE%BE%E8%AE%A1>阶段一: 数据库表设计</a></li><li><a href=#%E9%98%B6%E6%AE%B5%E4%BA%8C-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%83%A8%E7%BD%B2>阶段二: 数据库部署</a></li><li><a href=#%E9%98%B6%E6%AE%B5%E4%B8%89-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96>阶段三: 数据库性能优化</a><ul><li><a href=#31-%E7%A1%AC%E4%BB%B6%E9%85%8D%E7%BD%AE>3.1 硬件配置</a></li><li><a href=#32-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BC%98%E5%8C%96>3.2 数据库配置优化</a></li><li><a href=#33-%E7%B3%BB%E7%BB%9F%E5%86%85%E6%A0%B8%E5%8F%82%E6%95%B0%E4%BC%98%E5%8C%96>3.3 系统内核参数优化</a></li></ul></li><li><a href=#%E9%98%B6%E6%AE%B5%E5%9B%9B-sql-%E8%AF%AD%E5%8F%A5%E4%BC%98%E5%8C%96>阶段四: SQL 语句优化</a></li><li><a href=#%E9%98%B6%E6%AE%B5%E4%BA%94-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9E%B6%E6%9E%84%E6%89%A9%E5%B1%95>阶段五: 数据库架构扩展</a><ul><li><a href=#51-%E5%A2%9E%E5%8A%A0-cache-%E7%BC%93%E5%AD%98>5.1 增加 cache 缓存</a></li><li><a href=#52-masterslave-%E5%A4%8D%E5%88%B6%E5%92%8C%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB>5.2 Master/Slave 复制和读写分离</a></li><li><a href=#53-%E5%88%86%E5%BA%93>5.3 分库</a></li><li><a href=#54-%E5%88%86%E8%A1%A8>5.4 分表</a></li><li><a href=#55-%E5%88%86%E5%8C%BA>5.5 分区</a></li></ul></li><li><a href=#%E9%98%B6%E6%AE%B5%E5%85%AD-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%B4%E6%8A%A4>阶段六: 数据库维护</a><ul><li><a href=#61-%E6%80%A7%E8%83%BD%E7%8A%B6%E6%80%81%E5%85%B3%E9%94%AE%E6%8C%87%E6%A0%87-quota>6.1 性能状态关键指标 quota</a><ul><li><a href=#611-qps>6.1.1 QPS</a></li><li><a href=#612-tps>6.1.2 TPS</a></li></ul></li><li><a href=#62-%E5%BC%80%E5%90%AF%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97>6.2 开启慢查询日志</a></li><li><a href=#63-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD>6.3 数据库备份</a></li><li><a href=#64-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%AE%E5%A4%8D>6.4 数据库修复</a></li><li><a href=#65-mysql-%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90>6.5 mysql 服务器性能分析</a></li></ul></li><li><a href=#%E9%98%B6%E6%AE%B5%E4%B8%83-%E5%85%B6%E4%BB%96>阶段七: 其他</a></li></ul><h1 id=阶段一-数据库表设计>阶段一: 数据库表设计</h1><ul><li>表结构设计</li></ul><h1 id=阶段二-数据库部署>阶段二: 数据库部署</h1><ul><li>主从复制</li><li>集群</li><li>主从复制+Keepalived 实现双机热备份</li></ul><blockquote><p>主流的 HA 软件有: Keepalived,Heartbeat</p></div><div class=read-more><a href=/post/database/005-mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96%E6%9C%80%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/post/golang/011-convert-json-to-csv/>01-Convert json to csv</a></h1><div class=post-meta><span class=post-time>2021-06-09</span><div class=post-category><a href=/categories/go/>Go</a></div></div></header><div class=post-content><div class=post-summary><h1 id=table-of-contents>Table of Contents</h1><ul><li><a href=#table-of-contents>Table of Contents</a></li><li><a href=#1-convert-json-to-csv>1: Convert json to csv</a><ul><li><a href=#11-json-%E6%96%87%E4%BB%B6>1.1 json 文件</a></li><li><a href=#12-convert>1.2 convert</a></li></ul></li></ul><h1 id=1-convert-json-to-csv>1: Convert json to csv</h1><h2 id=11-json-文件>1.1 json 文件</h2><ul><li>company.json</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span> <span class=nt>&#34;App&#34;</span><span class=p>:</span> <span class=s2>&#34;Instagram&#34;</span><span class=p>,</span> <span class=nt>&#34;Company&#34;</span><span class=p>:</span> <span class=s2>&#34;Facebook&#34;</span><span class=p>,</span> <span class=nt>&#34;Category&#34;</span><span class=p>:</span> <span class=s2>&#34;Social Media&#34;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span> <span class=nt>&#34;App&#34;</span><span class=p>:</span> <span class=s2>&#34;WeChat&#34;</span><span class=p>,</span> <span class=nt>&#34;Company&#34;</span><span class=p>:</span> <span class=s2>&#34;Tencent&#34;</span><span class=p>,</span> <span class=nt>&#34;Category&#34;</span><span class=p>:</span> <span class=s2>&#34;Social Media&#34;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span> <span class=nt>&#34;App&#34;</span><span class=p>:</span> <span class=s2>&#34;Hotstar&#34;</span><span class=p>,</span> <span class=nt>&#34;Company&#34;</span><span class=p>:</span> <span class=s2>&#34;Disney&#34;</span><span class=p>,</span> <span class=nt>&#34;Category&#34;</span><span class=p>:</span> <span class=s2>&#34;Entertainment&#34;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span> <span class=nt>&#34;App&#34;</span><span class=p>:</span> <span class=s2>&#34;CNBC&#34;</span><span class=p>,</span> <span class=nt>&#34;Company&#34;</span><span class=p>:</span> <span class=s2>&#34;Comcast&#34;</span><span class=p>,</span> <span class=nt>&#34;Category&#34;</span><span class=p>:</span> <span class=s2>&#34;News&#34;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span> <span class=nt>&#34;App&#34;</span><span class=p>:</span> <span class=s2>&#34;SnapChat&#34;</span><span class=p>,</span> <span class=nt>&#34;Company&#34;</span><span class=p>:</span> <span class=s2>&#34;Snap&#34;</span><span class=p>,</span> <span class=nt>&#34;Category&#34;</span><span class=p>:</span> <span class=s2>&#34;Social Media&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=12-convert>1.2 convert</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>package main
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>import <span class=o>(</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;encoding/csv&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;encoding/json&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;io/ioutil&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// Application struct
</span></span><span class=line><span class=cl><span class=nb>type</span> Application struct <span class=o>{</span>
</span></span><span class=line><span class=cl>    App      string
</span></span><span class=line><span class=cl>    Company  string
</span></span><span class=line><span class=cl>    Category string
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>func main<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    // <span class=nb>read</span> data from file
</span></span><span class=line><span class=cl>    jsonDataFromFile, err :<span class=o>=</span> ioutil.ReadFile<span class=o>(</span><span class=s2>&#34;./company.json&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> err !<span class=o>=</span> nil <span class=o>{</span>
</span></span><span class=line><span class=cl>        fmt.Println<span class=o>(</span>err<span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // Unmarshal JSON data
</span></span><span class=line><span class=cl>    var jsonData <span class=o>[]</span>Application
</span></span><span class=line><span class=cl>    <span class=nv>err</span> <span class=o>=</span> json.Unmarshal<span class=o>([]</span>byte<span class=o>(</span>jsonDataFromFile<span class=o>)</span>, <span class=p>&amp;</span>jsonData<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> err !<span class=o>=</span> nil <span class=o>{</span>
</span></span><span class=line><span class=cl>        fmt.Println<span class=o>(</span>err<span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    csvFile, err :<span class=o>=</span> os.Create<span class=o>(</span><span class=s2>&#34;./data.csv&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> err !<span class=o>=</span> nil <span class=o>{</span>
</span></span><span class=line><span class=cl>        fmt.Println<span class=o>(</span>err<span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    defer csvFile.Close<span class=o>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    writer :<span class=o>=</span> csv.NewWriter<span class=o>(</span>csvFile<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> _, usance :<span class=o>=</span> range jsonData <span class=o>{</span>
</span></span><span class=line><span class=cl>        var row <span class=o>[]</span>string
</span></span><span class=line><span class=cl>        <span class=nv>row</span> <span class=o>=</span> append<span class=o>(</span>row, usance.App<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=nv>row</span> <span class=o>=</span> append<span class=o>(</span>row, usance.Company<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=nv>row</span> <span class=o>=</span> append<span class=o>(</span>row, usance.Category<span class=o>)</span>
</span></span><span class=line><span class=cl>        writer.Write<span class=o>(</span>row<span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // remember to flush!
</span></span><span class=line><span class=cl>    writer.Flush<span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div></div><div class=read-more><a href=/post/golang/011-convert-json-to-csv/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/post/dockerk8s/005-minikube%E6%90%AD%E5%BB%BA/>01-MInikube搭建</a></h1><div class=post-meta><span class=post-time>2021-06-07</span><div class=post-category><a href=/categories/k8s/>k8s</a></div></div></header><div class=post-content><div class=post-summary><p>[toc]</p><h1 id=1-安装-docker-环境>1: 安装 Docker 环境</h1><h2 id=11-安装-docker>1.1: 安装 docker</h2><h2 id=12-配置-docker>1.2: 配置 docker</h2><p>docker 加速 <code>/etc/docker/daemon.json</code>
重启 docker,使配置生效</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl daemon-reload
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo systemctl restart docker
</span></span></code></pre></td></tr></table></div></div><h1 id=2-安装-minikube>2: 安装 Minikube</h1><p><a href=https://cloud.tencent.com/developer/article/1817826>https://cloud.tencent.com/developer/article/1817826</a></p><h2 id=21-使用普通的-minikube>2.1 使用普通的 minikube</h2><h3 id=211-更新软件源>2.1.1 更新软件源</h3><h3 id=212-更新软件包>2.1.2 更新软件包</h3><h3 id=213-安装-docker>2.1.3 安装 docker</h3><h3 id=214-安装-k8s>2.1.4 安装 k8s</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 执行以下命令安装 https 工具以及 k8s</span>
</span></span><span class=line><span class=cl>apt-get update <span class=o>&amp;&amp;</span> apt-get install -y apt-transport-https curl
</span></span><span class=line><span class=cl>apt-get install -y kubelet kubeadm kubectl --allow-unauthenticated
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 执行下面命令测试是否正常</span>
</span></span><span class=line><span class=cl>kubeadm init
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 如果安装时，出现下面情况，说明系统得镜像源中，找不到 k8s 的软件包</span>
</span></span><span class=line><span class=cl>No apt package <span class=s2>&#34;kubeadm&#34;</span>, but there is a snap with that name.
</span></span><span class=line><span class=cl>Try <span class=s2>&#34;snap install kubeadm&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>No apt package <span class=s2>&#34;kubectl&#34;</span>, but there is a snap with that name.
</span></span><span class=line><span class=cl>Try <span class=s2>&#34;snap install kubectl&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 可以打开 /etc/apt/sources.list  文件，添加一行</span>
</span></span><span class=line><span class=cl>deb https://mirrors.aliyun.com/kubernetes/apt kubernetes-xenial main
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 再次执行安装k8s</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 如果出现下面</span>
</span></span><span class=line><span class=cl>The following signatures couldn<span class=err>&#39;</span>t be verified because the public key is not available
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 则执行下面命令，添加key</span>
</span></span><span class=line><span class=cl>curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg <span class=p>|</span> sudo apt-key add
</span></span></code></pre></td></tr></table></div></div><blockquote><p>上面命令，安装了 <code>kubelet</code>、<code>kubeadm</code>、<code>kubectl</code></p></div><div class=read-more><a href=/post/dockerk8s/005-minikube%E6%90%AD%E5%BB%BA/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/post/linux/029-nginx%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E6%B8%85%E5%8D%95/>01-Nginx 常用配置清单.md</a></h1><div class=post-meta><span class=post-time>2021-06-06</span><div class=post-category><a href=/categories/linux/>Linux</a></div></div></header><div class=post-content><div class=post-summary><p>Table of Contents</p><ul><li><a href=#1-nginx-%E9%85%8D%E7%BD%AE>1: Nginx 配置</a></li><li><a href=#2-listen-port>2: Listen Port</a></li><li><a href=#3-access-log>3: Access Log</a></li><li><a href=#4-domain-name>4: Domain Name</a></li><li><a href=#5-static-asset>5: Static Asset</a></li><li><a href=#6-redirect>6: Redirect</a></li><li><a href=#7-reverse-proxy>7: Reverse Proxy</a></li><li><a href=#8-nginx-%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F>8: Nginx 解决跨域</a></li><li><a href=#8-load-balance>8: Load Balance</a><ul><li><a href=#81-roundrobin-%E8%BD%AE%E8%AF%A2default>8.1 RoundRobin 轮询(default)</a></li><li><a href=#82-weight-%E6%9D%83%E9%87%8D>8.2 weight (权重)</a></li><li><a href=#83-ip_haship-%E7%BB%91%E5%AE%9A-ip_hash->8.3 ip_hash（IP 绑定 ip_hash ）</a></li><li><a href=#84-url_hash>8.4 url_hash</a></li><li><a href=#85-fair%E7%AC%AC%E4%B8%89%E6%96%B9>8.5 fair（第三方）</a></li></ul></li><li><a href=#9-ssl-%E5%8D%8F%E8%AE%AE>9: SSL 协议</a></li><li><a href=#10-nginx-%E5%8A%A0%E9%80%9F>10: Nginx 加速</a><ul><li><a href=#101-%E5%90%AF%E7%94%A8-gzip-%E5%8E%8B%E7%BC%A9>10.1 启用 Gzip 压缩</a></li><li><a href=#102-%E8%AE%BE%E7%BD%AE%E7%BC%93%E5%AD%98%E5%A4%B4>10.2 设置缓存头</a></li><li><a href=#103-%E5%90%AF%E7%94%A8-http2-%E5%8D%8F%E8%AE%AE>10.3 启用 HTTP2 协议</a></li><li><a href=#104-%E4%BC%98%E5%8C%96%E6%97%A5%E5%BF%97-optimizing-logging>10.4 优化日志 Optimizing Logging</a><ul><li><a href=#1041-%E7%A6%81%E7%94%A8%E9%A1%B5%E9%9D%A2%E8%B5%84%E6%BA%90%E8%AF%B7%E6%B1%82%E7%9A%84%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95>10.4.1 禁用页面资源请求的日志记录</a></li><li><a href=#1042-%E7%A6%81%E7%94%A8%E6%88%90%E5%8A%9F%E8%AF%B7%E6%B1%82%E7%9A%84%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95>10.4.2 禁用成功请求的日志记录</a></li><li><a href=#1043-%E6%9C%80%E5%B0%8F%E5%8C%96-io-%E6%93%8D%E4%BD%9C>10.4.3 最小化 I/O 操作</a></li></ul></li><li><a href=#105-%E9%99%90%E5%88%B6%E5%B8%A6%E5%AE%BD>10.5 限制带宽</a></li></ul></li><li><a href=#11-location-%E8%AF%AD%E6%B3%95>11: location 语法</a></li><li><a href=#12-nginx-%E9%AB%98%E5%8F%AF%E7%94%A8-keepalived>12: nginx 高可用 keepalived</a></li></ul><h1 id=1-nginx-配置>1: Nginx 配置</h1><ul><li><p><a href=https://mp.weixin.qq.com/s/6LwDWI9z5wxbaeG33FEAGw>https://mp.weixin.qq.com/s/6LwDWI9z5wxbaeG33FEAGw</a></p></div><div class=read-more><a href=/post/linux/029-nginx%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E6%B8%85%E5%8D%95/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/post/linux/027-nginx-ssl%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81/>01-nginx ssl双向认证.md</a></h1><div class=post-meta><span class=post-time>2021-06-03</span><div class=post-category><a href=/categories/linux/>Linux</a></div></div></header><div class=post-content><div class=post-summary><h1 id=table-of-contents>Table of Contents</h1><ul><li><a href=#table-of-contents>Table of Contents</a></li><li><a href=#1-nginx-ssl-setting>1: Nginx SSL Setting</a></li><li><a href=#2-openssl-%E9%85%8D%E7%BD%AE%E5%87%86%E5%A4%87>2: openssl 配置准备</a></li><li><a href=#3-%E5%88%9B%E5%BB%BA-ca-%E6%A0%B9%E7%BA%A7%E8%AF%81%E4%B9%A6>3: 创建 CA 根级证书</a></li><li><a href=#4-%E5%88%9B%E5%BB%BA-server-%E8%AF%81%E4%B9%A6>4: 创建 server 证书</a></li><li><a href=#5-%E5%88%9B%E5%BB%BA-client-%E8%AF%81%E4%B9%A6>5: 创建 client 证书</a></li><li><a href=#6-%E9%85%8D%E7%BD%AE-nginx-ssl>6: 配置 Nginx ssl</a></li></ul><h1 id=1-nginx-ssl-setting>1: Nginx SSL Setting</h1><blockquote><p><strong>Nginx 对 SSL 双向认证支持的比较好，配置很简单：</strong></p></div><div class=read-more><a href=/post/linux/027-nginx-ssl%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81/ class=read-more-link>阅读更多</a></div></div></article><article class=post><header class=post-header><h1 class=post-title><a class=post-link href=/post/dockerk8s/003-docker%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3/>01-Docker命令详解.md</a></h1><div class=post-meta><span class=post-time>2021-05-31</span><div class=post-category><a href=/categories/docker/>Docker</a></div></div></header><div class=post-content><div class=post-summary><h1 id=table-of-contents>Table of Contents</h1><ul><li><a href=#1-docker>1: docker</a></li><li><a href=#2-docker%E7%9A%84%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4>2: docker 的使用命令</a><ul><li><a href=#21-docker---help>2.1 docker &ndash;help</a></li><li><a href=#22-docker-build>2.2 docker build</a></li><li><a href=#23-docker-run>2.3 docker run</a></li><li><a href=#24-%E4%BF%9D%E5%AD%98%E5%92%8C%E5%8A%A0%E8%BD%BD%E9%95%9C%E5%83%8F>2.4 保存和加载镜像</a></li></ul></li><li><a href=#3-docker-container>3: docker Container</a></li><li><a href=#4-docker-network>4: docker Network</a></li><li><a href=#5-docker-volume>5: docker volume</a></li><li><a href=#6-%E5%8F%91%E5%B8%83%E9%95%9C%E5%83%8F>6: 发布镜像</a></li><li><a href=#7-dockerfile>7: Dockerfile</a></li><li><a href=#8-other>8: other</a></li></ul><h1 id=1-docker>1: docker</h1><ul><li>容器技术</li><li>image</li><li>container</li><li>repository</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 1: pdocker ps 显示过长问题：</span>
</span></span><span class=line><span class=cl>docker ps --format <span class=s2>&#34;table {{.ID}}\t{{.Image}}\t{{.Status}}\t{{.Names}}&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker ps <span class=p>|</span> less -S
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2: docker如何将容器内文件复制到本地</span>
</span></span><span class=line><span class=cl>docker container cp -a c56d9375ff28:/etc/kraken ./
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3:</span>
</span></span><span class=line><span class=cl>CMD: 指定容器被启动时要运行的命令
</span></span><span class=line><span class=cl>ENTRYPOINT: 同 CMD ,但不会被 docker run -t 覆盖
</span></span></code></pre></td></tr></table></div></div><h1 id=2-docker-的使用命令>2: docker 的使用命令</h1><h2 id=21-docker-help>2.1 docker &ndash;help</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker --help
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>管理命令:
</span></span><span class=line><span class=cl>  container   管理容器
</span></span><span class=line><span class=cl>  image       管理镜像
</span></span><span class=line><span class=cl>  network     管理网络
</span></span><span class=line><span class=cl>命令：
</span></span><span class=line><span class=cl>  attach      介入到一个正在运行的容器
</span></span><span class=line><span class=cl>  build       根据 dockerfile 构建一个镜像
</span></span><span class=line><span class=cl>  commit      根据容器的更改创建一个新的镜像
</span></span><span class=line><span class=cl>  cp          在本地文件系统与容器中复制 文件/文件夹
</span></span><span class=line><span class=cl>  create      创建一个新容器
</span></span><span class=line><span class=cl>  <span class=nb>exec</span>        在容器中执行一条命令
</span></span><span class=line><span class=cl>  images      列出镜像
</span></span><span class=line><span class=cl>  <span class=nb>kill</span>        杀死一个或多个正在运行的容器
</span></span><span class=line><span class=cl>  logs        取得容器的日志
</span></span><span class=line><span class=cl>  pause       暂停一个或多个容器的所有进程
</span></span><span class=line><span class=cl>  ps          列出所有容器
</span></span><span class=line><span class=cl>  pull        拉取一个镜像或仓库到 registry
</span></span><span class=line><span class=cl>  push        推送一个镜像或仓库到 registry
</span></span><span class=line><span class=cl>  rename      重命名一个容器
</span></span><span class=line><span class=cl>  restart     重新启动一个或多个容器
</span></span><span class=line><span class=cl>  rm          删除一个或多个容器
</span></span><span class=line><span class=cl>  rmi         删除一个或多个镜像
</span></span><span class=line><span class=cl>  run         在一个新的容器中执行一条命令
</span></span><span class=line><span class=cl>  search      在 Docker Hub 中搜索镜像
</span></span><span class=line><span class=cl>  start       启动一个或多个已经停止运行的容器
</span></span><span class=line><span class=cl>  stats       显示一个容器的实时资源占用
</span></span><span class=line><span class=cl>  stop        停止一个或多个正在运行的容器
</span></span><span class=line><span class=cl>  tag         为镜像创建一个新的标签
</span></span><span class=line><span class=cl>  top         显示一个容器内的所有进程
</span></span><span class=line><span class=cl>  unpause     恢复一个或多个容器内所有被暂停的进程
</span></span></code></pre></td></tr></table></div></div><h2 id=22-docker-build>2.2 docker build</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>命令格式：docker build <span class=o>[</span>OPTIONS<span class=o>]</span> &lt;PATH <span class=p>|</span> URL <span class=p>|</span> -&gt;
</span></span><span class=line><span class=cl>Usage: Build an image from a Dockerfile.
</span></span><span class=line><span class=cl>常用选项说明
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--build-arg       设置构建时的变量
</span></span><span class=line><span class=cl>--no-cache        默认false。设置该选项，将不使用Build Cache构建镜像
</span></span><span class=line><span class=cl>--pull            默认false。设置该选项，总是尝试pull镜像的最新版本
</span></span><span class=line><span class=cl>--compress        默认false。设置该选项，将使用gzip压缩构建的上下文
</span></span><span class=line><span class=cl>--disable-content-trust 默认true。设置该选项，将对镜像进行验证
</span></span><span class=line><span class=cl>--file, -f        Dockerfile的完整路径，默认值为‘PATH/Dockerfile’
</span></span><span class=line><span class=cl>--isolation       默认--isolation<span class=o>=</span><span class=s2>&#34;default&#34;</span>，即Linux命名空间；其他还有process或hyperv
</span></span><span class=line><span class=cl>--label           为生成的镜像设置metadata
</span></span><span class=line><span class=cl>--squash          默认false。设置该选项，将新构建出的多个层压缩为一个新层，但是将无法在多个镜像之间共享新层；设置该选项，实际上是创建了新image，同时保留原有image。
</span></span><span class=line><span class=cl>--tag, -t         镜像的名字及tag，通常name:tag或者name格式；可以在一次构建中为一个镜像设置多个tag
</span></span><span class=line><span class=cl>--network         默认default。设置该选项，Set the networking mode <span class=k>for</span> the RUN instructions during build
</span></span><span class=line><span class=cl>--quiet, -q       默认false。设置该选项，Suppress the build output and print image ID on success
</span></span><span class=line><span class=cl>--force-rm        默认false。设置该选项，总是删除掉中间环节的容器
</span></span><span class=line><span class=cl>--rm，默认--rm<span class=o>=</span><span class=nb>true</span> 即整个构建过程成功后删除中间环节的容器
</span></span></code></pre></td></tr></table></div></div><blockquote><p>示例</p></div><div class=read-more><a href=/post/dockerk8s/003-docker%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3/ class=read-more-link>阅读更多</a></div></div></article></section><nav class=pagination><a class=prev href=/page/7/><i class="iconfont icon-left"></i>
<span class=prev-text>上一页</span>
</a><a class=next href=/page/9/><span class=next-text>下一页</span>
<i class="iconfont icon-right"></i></a></nav></div></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:golpp@qq.com class="iconfont icon-email" title=email></a><a href=http://localhost:1313 class="iconfont icon-stack-overflow" title=stack-overflow></a><a href=http://localhost:1313 class="iconfont icon-twitter" title=twitter></a><a href=http://localhost:1313 class="iconfont icon-facebook" title=facebook></a><a href=https://github.com/lppgo class="iconfont icon-github" title=github></a><a href=http://localhost:1313 class="iconfont icon-weibo" title=weibo></a><a href=https://github.com/lppgo class="iconfont icon-gitlab" title=gitlab></a><a href=http://localhost:1313 class="iconfont icon-bilibili" title=bilibili></a><a href=/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>由 <a class=hexo-link href=https://gohugo.io>Hugo</a> 强力驱动
</span><span class=division>|</span>
<span class=theme-info>主题 -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a>
</span><span class=copyright-year>&copy;
2015 -
2026<span class=heart><i class="iconfont icon-heart"></i></span><span></span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js></script><script id=baidu_push>(function(){if(window.location.hostname==="localhost")return;var t,n,e=document.createElement("script");e.async=!0,n=window.location.protocol.split(":")[0],n==="https"?e.src="https://zz.bdstatic.com/linksubmit/push.js":e.src="http://push.zhanzhang.baidu.com/push.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})()</script></body></html>